<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>TPMFactoryUpd: Source/Common/Crypt/Linux/Crypt.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="IFXStyleSheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="100%" cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo" style="vertical-align: middle"><img alt="Logo" src="infineon_large.png" style="padding: 5%;" /></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">TPMFactoryUpd
   &#160;<span id="projectnumber">01.01.2529.00</span>
   </div>
   <div id="projectbrief">A factory tool for updating the firmware of an Infineon Technologies TPM</div>
  </td>
  <td style="vertical-align:top; text-align: right; padding-right: 0.2em"><font color="#E20036"><b>Restricted</b></font></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="dir_573d75420a9527d403ae2af0f90fb3b6.html">Common</a></li><li class="navelem"><a class="el" href="dir_a966cbb3bc718ed03ac7609b6163fbf6.html">Crypt</a></li><li class="navelem"><a class="el" href="dir_5ae73c25792f514488e5209e3074e656.html">Linux</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Crypt.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements the Cryptography interface for Linux.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_crypt_8h_source.html">Crypt.h</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;openssl/hmac.h&gt;</code><br />
<code>#include &lt;openssl/rand.h&gt;</code><br />
<code>#include &lt;openssl/rsa.h&gt;</code><br />
<code>#include &lt;openssl/sha.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3fa563f9f16467407929143b1b0a30ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a3fa563f9f16467407929143b1b0a30ea">CRC32MASKREV</a>&#160;&#160;&#160;0xEDB88320</td></tr>
<tr class="memdesc:a3fa563f9f16467407929143b1b0a30ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">The used CRC-32 polynomial in hexadecimal representation.  <a href="#a3fa563f9f16467407929143b1b0a30ea">More...</a><br /></td></tr>
<tr class="separator:a3fa563f9f16467407929143b1b0a30ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4ca4a082d8c4eb0dd2b367fad3e2bfb0"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a4ca4a082d8c4eb0dd2b367fad3e2bfb0">Crypt_CRC</a> (_In_bytecount_(PnInputDataSize) const void *PpInputData, _In_ int PnInputDataSize, _Inout_ unsigned int *PpunCRC)</td></tr>
<tr class="memdesc:a4ca4a082d8c4eb0dd2b367fad3e2bfb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the CRC value of the given data stream.  <a href="#a4ca4a082d8c4eb0dd2b367fad3e2bfb0">More...</a><br /></td></tr>
<tr class="separator:a4ca4a082d8c4eb0dd2b367fad3e2bfb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9969cf56dabe0938eb4978d05c4d5dac"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a9969cf56dabe0938eb4978d05c4d5dac">Crypt_EncryptRSA</a> (_In_ <a class="el" href="_crypt_8h.html#abba6aad01824b33435e33abacef99ea3">CRYPT_ENC_SCHEME</a> PusEncryptionScheme, _In_ unsigned int PunInputDataSize, _In_bytecount_(PunInputDataSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbInputData, _In_ unsigned int PunPublicModulusSize, _In_bytecount_(PunPublicModulusSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbPublicModulus, _In_ unsigned int PunPublicExponentSize, _In_bytecount_(PunPublicExponentSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbPublicExponent, _Inout_ unsigned int *PpunEncryptedDataSize, _Inout_bytecap_(*PpunEncryptedDataSize) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbEncryptedData)</td></tr>
<tr class="memdesc:a9969cf56dabe0938eb4978d05c4d5dac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a byte array with a RSA 2048-bit public key.  <a href="#a9969cf56dabe0938eb4978d05c4d5dac">More...</a><br /></td></tr>
<tr class="separator:a9969cf56dabe0938eb4978d05c4d5dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70fd4b4b33501e37dff8e4db2ac01402"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a70fd4b4b33501e37dff8e4db2ac01402">Crypt_GetRandom</a> (_In_ const <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a> PusRandomSize, _Out_bytecap_(PusRandomSize) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbRandom)</td></tr>
<tr class="memdesc:a70fd4b4b33501e37dff8e4db2ac01402"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get random bytes from the pseudo random number generator.  <a href="#a70fd4b4b33501e37dff8e4db2ac01402">More...</a><br /></td></tr>
<tr class="separator:a70fd4b4b33501e37dff8e4db2ac01402"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d89504cce3e2bddf73d4a8a27415a78"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a0d89504cce3e2bddf73d4a8a27415a78">Crypt_HMAC</a> (_In_bytecount_(PusInputMessageSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbInputMessage, _In_ <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a> PusInputMessageSize, _In_opt_bytecount_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> PrgbKey[<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>], _Out_bytecap_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> PrgbHMAC[<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>])</td></tr>
<tr class="memdesc:a0d89504cce3e2bddf73d4a8a27415a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate HMAC-SHA-1 on the given message.  <a href="#a0d89504cce3e2bddf73d4a8a27415a78">More...</a><br /></td></tr>
<tr class="separator:a0d89504cce3e2bddf73d4a8a27415a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fb3f96480236b06585604c76cbe4530"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a7fb3f96480236b06585604c76cbe4530">Crypt_SeedRandom</a> (_In_bytecount_(PusSeedSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbSeed, _In_ const <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a> PusSeedSize)</td></tr>
<tr class="memdesc:a7fb3f96480236b06585604c76cbe4530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Seed the pseudo random number generator.  <a href="#a7fb3f96480236b06585604c76cbe4530">More...</a><br /></td></tr>
<tr class="separator:a7fb3f96480236b06585604c76cbe4530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13f0e71bba47948c28c70b02f78b92bd"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a13f0e71bba47948c28c70b02f78b92bd">Crypt_SHA1</a> (_In_bytecount_(PusInputMessageSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbInputMessage, _In_ const <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a> PusInputMessageSize, _Out_bytecap_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> PrgbSHA1[<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>])</td></tr>
<tr class="memdesc:a13f0e71bba47948c28c70b02f78b92bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate SHA-1 on the given data.  <a href="#a13f0e71bba47948c28c70b02f78b92bd">More...</a><br /></td></tr>
<tr class="separator:a13f0e71bba47948c28c70b02f78b92bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c51994669394e5c0672fd8634b8a101"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a7c51994669394e5c0672fd8634b8a101">Crypt_SHA256</a> (_In_bytecount_(PunInputMessageSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbInputMessage, _In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a> PunInputMessageSize, _Out_bytecap_(<a class="el" href="_t_p_m2___types_8h.html#a81efbc0fc101b06a914f7ff9e2fbc0e9">SHA256_DIGEST_SIZE</a>) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> PrgbSHA256[<a class="el" href="_t_p_m2___types_8h.html#a81efbc0fc101b06a914f7ff9e2fbc0e9">SHA256_DIGEST_SIZE</a>])</td></tr>
<tr class="memdesc:a7c51994669394e5c0672fd8634b8a101"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate SHA-256 on the given data.  <a href="#a7c51994669394e5c0672fd8634b8a101">More...</a><br /></td></tr>
<tr class="separator:a7c51994669394e5c0672fd8634b8a101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d1be575d78640147ba849a44cfd7b2b"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#a2d1be575d78640147ba849a44cfd7b2b">Crypt_VerifySignature</a> (_In_bytecount_(PunMessageHashSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbMessageHash, _In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a> PunMessageHashSize, _In_bytecount_(PunSignatureSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbSignature, _In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a> PunSignatureSize, _In_bytecount_(PunModulusSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbModulus, _In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a> PunModulusSize)</td></tr>
<tr class="memdesc:a2d1be575d78640147ba849a44cfd7b2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify the given RSA PKCS#1 RSASSA-PSS signature.  <a href="#a2d1be575d78640147ba849a44cfd7b2b">More...</a><br /></td></tr>
<tr class="separator:a2d1be575d78640147ba849a44cfd7b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:adf96097ff2cd148aadd03a9951cfb9f6"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crypt_8c.html#adf96097ff2cd148aadd03a9951cfb9f6">g_rgbOAEPPad</a> [] = { 'T', 'C', 'P', 'A' }</td></tr>
<tr class="memdesc:adf96097ff2cd148aadd03a9951cfb9f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">OAEP Pad.  <a href="#adf96097ff2cd148aadd03a9951cfb9f6">More...</a><br /></td></tr>
<tr class="separator:adf96097ff2cd148aadd03a9951cfb9f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the Cryptography interface for Linux. </p>
<p>This module provides cryptographic functions.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2016 - 2017 Infineon Technologies AG ( www.infineon.com )</dd>
<dd>
All rights reserved.</dd></dl>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p><ol type="1">
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </li>
</ol>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3fa563f9f16467407929143b1b0a30ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fa563f9f16467407929143b1b0a30ea">&#9670;&nbsp;</a></span>CRC32MASKREV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRC32MASKREV&#160;&#160;&#160;0xEDB88320</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The used CRC-32 polynomial in hexadecimal representation. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4ca4a082d8c4eb0dd2b367fad3e2bfb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ca4a082d8c4eb0dd2b367fad3e2bfb0">&#9670;&nbsp;</a></span>Crypt_CRC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_CRC </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PnInputDataSize) const void *&#160;</td>
          <td class="paramname"><em>PpInputData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ int&#160;</td>
          <td class="paramname"><em>PnInputDataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Inout_ unsigned int *&#160;</td>
          <td class="paramname"><em>PpunCRC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the CRC value of the given data stream. </p>
<p>The function calculates bitwise a CRC over a data stream</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PpInputData</td><td>Data stream for CRC calculation </td></tr>
    <tr><td class="paramname">PnInputDataSize</td><td>Size if data to calculate the CRC </td></tr>
    <tr><td class="paramname">PpunCRC</td><td>Calculated CRC value</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred during CRC calculation. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. It was NULL or empty. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9969cf56dabe0938eb4978d05c4d5dac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9969cf56dabe0938eb4978d05c4d5dac">&#9670;&nbsp;</a></span>Crypt_EncryptRSA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_EncryptRSA </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="_crypt_8h.html#abba6aad01824b33435e33abacef99ea3">CRYPT_ENC_SCHEME</a>&#160;</td>
          <td class="paramname"><em>PusEncryptionScheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ unsigned int&#160;</td>
          <td class="paramname"><em>PunInputDataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_bytecount_(PunInputDataSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbInputData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ unsigned int&#160;</td>
          <td class="paramname"><em>PunPublicModulusSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_bytecount_(PunPublicModulusSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbPublicModulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ unsigned int&#160;</td>
          <td class="paramname"><em>PunPublicExponentSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_bytecount_(PunPublicExponentSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbPublicExponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Inout_ unsigned int *&#160;</td>
          <td class="paramname"><em>PpunEncryptedDataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Inout_bytecap_ *PpunEncryptedDataSize <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbEncryptedData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a byte array with a RSA 2048-bit public key. </p>
<p>This function encrypts the given data stream with RSA 2048-bit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PusEncryptionScheme</td><td>Encryption scheme. Only CRYPT_ES_RSAESOAEP_SHA1_MGF1 is supported. </td></tr>
    <tr><td class="paramname">PunInputDataSize</td><td>Size of input data in bytes </td></tr>
    <tr><td class="paramname">PrgbInputData</td><td>Input data buffer </td></tr>
    <tr><td class="paramname">PunPublicModulusSize</td><td>Size of public modulus in bytes </td></tr>
    <tr><td class="paramname">PrgbPublicModulus</td><td>Public modulus buffer </td></tr>
    <tr><td class="paramname">PunPublicExponentSize</td><td>Size of public exponent in bytes </td></tr>
    <tr><td class="paramname">PrgbPublicExponent</td><td>Public exponent buffer </td></tr>
    <tr><td class="paramname">PpunEncryptedDataSize</td><td>In: Size of buffer for encrypted data in bytes Out: Size of encrypted data in bytes </td></tr>
    <tr><td class="paramname">PrgbEncryptedData</td><td>Encrypted data buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred during RSA functionality. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. It was NULL or empty. </td></tr>
    <tr><td class="paramname">RC_E_BUFFER_TOO_SMALL</td><td>In case of PrgbEncryptedData is too small </td></tr>
    <tr><td class="paramname">RC_E_INTERNAL</td><td>In case of a not supported padding schema </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a70fd4b4b33501e37dff8e4db2ac01402"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70fd4b4b33501e37dff8e4db2ac01402">&#9670;&nbsp;</a></span>Crypt_GetRandom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_GetRandom </td>
          <td>(</td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a>&#160;</td>
          <td class="paramname"><em>PusRandomSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_bytecap_(PusRandomSize) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbRandom</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get random bytes from the pseudo random number generator. </p>
<p>This function gets random bytes from the pseudo random number generator.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PusRandomSize</td><td>Number of bytes requested. </td></tr>
    <tr><td class="paramname">PrgbRandom</td><td>Receives pseudo random bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. PrgbRandom is NULL or PusRandomSize is 0 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0d89504cce3e2bddf73d4a8a27415a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d89504cce3e2bddf73d4a8a27415a78">&#9670;&nbsp;</a></span>Crypt_HMAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_HMAC </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PusInputMessageSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbInputMessage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a>&#160;</td>
          <td class="paramname"><em>PusInputMessageSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_opt_bytecount_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>PrgbKey</em>[SHA1_DIGEST_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_bytecap_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>PrgbHMAC</em>[SHA1_DIGEST_SIZE]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate HMAC-SHA-1 on the given message. </p>
<p>This function calculates a HMAC-SHA-1 on the input message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbInputMessage</td><td>Input message </td></tr>
    <tr><td class="paramname">PusInputMessageSize</td><td>Input message size in bytes </td></tr>
    <tr><td class="paramname">PrgbKey</td><td>Message authentication key </td></tr>
    <tr><td class="paramname">PrgbHMAC</td><td>Receives the HMAC</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. PrgbInputMessage is NULL or PusInputMessageSize is 0 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7fb3f96480236b06585604c76cbe4530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fb3f96480236b06585604c76cbe4530">&#9670;&nbsp;</a></span>Crypt_SeedRandom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_SeedRandom </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PusSeedSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbSeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a>&#160;</td>
          <td class="paramname"><em>PusSeedSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Seed the pseudo random number generator. </p>
<p>This function seeds the pseudo random number generator.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbSeed</td><td>Seed </td></tr>
    <tr><td class="paramname">PusSeedSize</td><td>Seed size in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. PrgbSeed is NULL and PusSeedSize is not 0. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a13f0e71bba47948c28c70b02f78b92bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13f0e71bba47948c28c70b02f78b92bd">&#9670;&nbsp;</a></span>Crypt_SHA1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_SHA1 </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PusInputMessageSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbInputMessage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#acbc04026a2008f7c2fccf01718291c20">UINT16</a>&#160;</td>
          <td class="paramname"><em>PusInputMessageSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_bytecap_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>PrgbSHA1</em>[SHA1_DIGEST_SIZE]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate SHA-1 on the given data. </p>
<p>This function calculates a SHA-1 hash on the given data stream.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbInputMessage</td><td>Input message </td></tr>
    <tr><td class="paramname">PusInputMessageSize</td><td>Input message size in bytes </td></tr>
    <tr><td class="paramname">PrgbSHA1</td><td>Receives the SHA-1</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. PrgbInputMessage is NULL or PusInputMessageSize is 0 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7c51994669394e5c0672fd8634b8a101"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c51994669394e5c0672fd8634b8a101">&#9670;&nbsp;</a></span>Crypt_SHA256()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_SHA256 </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PunInputMessageSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbInputMessage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a>&#160;</td>
          <td class="paramname"><em>PunInputMessageSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_bytecap_(<a class="el" href="_t_p_m2___types_8h.html#a81efbc0fc101b06a914f7ff9e2fbc0e9">SHA256_DIGEST_SIZE</a>) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>PrgbSHA256</em>[SHA256_DIGEST_SIZE]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate SHA-256 on the given data. </p>
<p>This function calculates a SHA-256 hash on the given data stream.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbInputMessage</td><td>Input message </td></tr>
    <tr><td class="paramname">PunInputMessageSize</td><td>Input message size in bytes </td></tr>
    <tr><td class="paramname">PrgbSHA256</td><td>Receives the SHA-256</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. PrgbInputMessage is NULL or PunInputMessageSize is 0 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2d1be575d78640147ba849a44cfd7b2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d1be575d78640147ba849a44cfd7b2b">&#9670;&nbsp;</a></span>Crypt_VerifySignature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int Crypt_VerifySignature </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PunMessageHashSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbMessageHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a>&#160;</td>
          <td class="paramname"><em>PunMessageHashSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_bytecount_(PunSignatureSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbSignature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a>&#160;</td>
          <td class="paramname"><em>PunSignatureSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_bytecount_(PunModulusSize) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbModulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a>&#160;</td>
          <td class="paramname"><em>PunModulusSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verify the given RSA PKCS#1 RSASSA-PSS signature. </p>
<p>This function verifies the given RSA PKCS#1 RSASSA-PSS signature with a RSA 2048-bit public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbMessageHash</td><td>Message hash buffer </td></tr>
    <tr><td class="paramname">PunMessageHashSize</td><td>Size of message hash buffer </td></tr>
    <tr><td class="paramname">PrgbSignature</td><td>Signature buffer </td></tr>
    <tr><td class="paramname">PunSignatureSize</td><td>Size of the signature buffer </td></tr>
    <tr><td class="paramname">PrgbModulus</td><td>Public modulus buffer </td></tr>
    <tr><td class="paramname">PunModulusSize</td><td>Size of public modulus buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred during RSA functionality. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. An input parameter is NULL or empty </td></tr>
    <tr><td class="paramname">RC_E_VERIFY_SIGNATURE</td><td>In case the signature is invalid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="adf96097ff2cd148aadd03a9951cfb9f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf96097ff2cd148aadd03a9951cfb9f6">&#9670;&nbsp;</a></span>g_rgbOAEPPad</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> g_rgbOAEPPad[] = { 'T', 'C', 'P', 'A' }</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>OAEP Pad. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/>
<p style="float: left; padding-left:0.2em"><font color="#E20036"><b>Restricted</b></font></p>
<p style="float: right;">Copyright © 2017 Infineon Technologies AG ( www.infineon.com ). All Rights Reserved.<br>&nbsp;</p>
</body>
</html>
