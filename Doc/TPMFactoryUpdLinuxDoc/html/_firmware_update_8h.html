<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<title>TPMFactoryUpd: Source/Common/FirmwareUpdate.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="IFXStyleSheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table width="100%" cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo" style="vertical-align: middle"><img alt="Logo" src="infineon_large.png" style="padding: 5%;" /></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">TPMFactoryUpd
   &#160;<span id="projectnumber">01.01.2529.00</span>
   </div>
   <div id="projectbrief">A factory tool for updating the firmware of an Infineon Technologies TPM</div>
  </td>
  <td style="vertical-align:top; text-align: right; padding-right: 0.2em"><font color="#E20036"><b>Restricted</b></font></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="dir_573d75420a9527d403ae2af0f90fb3b6.html">Common</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">FirmwareUpdate.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declares common firmware update functionality used by different tools.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;StdInclude.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_t_p_m2___types_8h_source.html">TPM2_Types.h</a>&quot;</code><br />
</div>
<p><a href="_firmware_update_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_b_i_t_f_i_e_l_d___n_e_w___t_p_m___f_i_r_m_w_a_r_e___i_n_f_o.html">BITFIELD_NEW_TPM_FIRMWARE_INFO</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">TPM state after firmware update used in FirmwareUpdate interface methods.  <a href="struct_b_i_t_f_i_e_l_d___n_e_w___t_p_m___f_i_r_m_w_a_r_e___i_n_f_o.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_b_i_t_f_i_e_l_d___t_p_m___a_t_t_r_i_b_u_t_e_s.html">BITFIELD_TPM_ATTRIBUTES</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">TPM state attributes used in FirmwareUpdate interface methods.  <a href="struct_b_i_t_f_i_e_l_d___t_p_m___a_t_t_r_i_b_u_t_e_s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_ifx_firmware_update_data.html">IfxFirmwareUpdateData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Firmware Update Data structure.  <a href="struct_ifx_firmware_update_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_t_p_m___s_t_a_t_e.html">TPM_STATE</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">TPM state.  <a href="struct_t_p_m___s_t_a_t_e.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1b8691f5d12f60b8d65ffa661601fd78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#a1b8691f5d12f60b8d65ffa661601fd78">REMAINING_UPDATES_UNAVAILABLE</a>&#160;&#160;&#160;(unsigned int)(-1)</td></tr>
<tr class="memdesc:a1b8691f5d12f60b8d65ffa661601fd78"><td class="mdescLeft">&#160;</td><td class="mdescRight">This value indicates that the number of remaining firmware updates is unknown.  <a href="#a1b8691f5d12f60b8d65ffa661601fd78">More...</a><br /></td></tr>
<tr class="separator:a1b8691f5d12f60b8d65ffa661601fd78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:abc0806f5fb50bb895b973508020604df"><td class="memItemLeft" align="right" valign="top">typedef unsigned long long(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#abc0806f5fb50bb895b973508020604df">PFN_FIRMWAREUPDATE_PROGRESSCALLBACK</a>) (unsigned long long PullCompletion)</td></tr>
<tr class="memdesc:abc0806f5fb50bb895b973508020604df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function pointer type definition for Response_ProgressCallback.  <a href="#abc0806f5fb50bb895b973508020604df">More...</a><br /></td></tr>
<tr class="separator:abc0806f5fb50bb895b973508020604df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62256d7910506f23f12dec62be3a6d6a"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#a62256d7910506f23f12dec62be3a6d6a">PFN_FIRMWAREUPDATE_UPDATESTARTEDCALLBACK</a>) ()</td></tr>
<tr class="memdesc:a62256d7910506f23f12dec62be3a6d6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function pointer type definition for UpdateStarted_Callback.  <a href="#a62256d7910506f23f12dec62be3a6d6a">More...</a><br /></td></tr>
<tr class="separator:a62256d7910506f23f12dec62be3a6d6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0377c76556033d78a1b3b1af60b6692a"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#a0377c76556033d78a1b3b1af60b6692a">FirmwareUpdate_CalculateState</a> (_Out_ <a class="el" href="struct_t_p_m___s_t_a_t_e.html">TPM_STATE</a> *PpsTpmState)</td></tr>
<tr class="memdesc:a0377c76556033d78a1b3b1af60b6692a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the TPM state attributes.  <a href="#a0377c76556033d78a1b3b1af60b6692a">More...</a><br /></td></tr>
<tr class="separator:a0377c76556033d78a1b3b1af60b6692a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845ea7abd1bced9eb1c358bc2e954d8e"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#a845ea7abd1bced9eb1c358bc2e954d8e">FirmwareUpdate_CheckImage</a> (_In_bytecount_(PullImageSize) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *PrgbImage, _In_ <a class="el" href="_t_p_m2___types_8h.html#a95df6cdb32afc350ff070f2fe8a54a67">UINT64</a> PullImageSize, _Out_ <a class="el" href="_globals_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *PpfValid, _Out_ <a class="el" href="struct_b_i_t_f_i_e_l_d___n_e_w___t_p_m___f_i_r_m_w_a_r_e___i_n_f_o.html">BITFIELD_NEW_TPM_FIRMWARE_INFO</a> *PpbfNewTpmFirmwareInfo, _Out_ <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a> *PpunErrorDetails)</td></tr>
<tr class="memdesc:a845ea7abd1bced9eb1c358bc2e954d8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the firmware image is valid for the TPM.  <a href="#a845ea7abd1bced9eb1c358bc2e954d8e">More...</a><br /></td></tr>
<tr class="separator:a845ea7abd1bced9eb1c358bc2e954d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87fa675eeff94b93fe70af6949ff7c2"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#ab87fa675eeff94b93fe70af6949ff7c2">FirmwareUpdate_CheckOwnerAuthorization</a> (_In_bytecount_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> PrgbOwnerAuthHash[<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>])</td></tr>
<tr class="memdesc:ab87fa675eeff94b93fe70af6949ff7c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks TPM Owner authorization on TPM1.2.  <a href="#ab87fa675eeff94b93fe70af6949ff7c2">More...</a><br /></td></tr>
<tr class="separator:ab87fa675eeff94b93fe70af6949ff7c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57734866cfa76a17da2cd78309267e00"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#a57734866cfa76a17da2cd78309267e00">FirmwareUpdate_GetImageInfo</a> (_Inout_bytecap_(*PpunVersionNameSize) wchar_t *PwszVersionName, _Inout_ unsigned int *PpunVersionNameSize, _Inout_ <a class="el" href="struct_t_p_m___s_t_a_t_e.html">TPM_STATE</a> *PpsTpmState, _Inout_ unsigned int *PpunRemainingUpdates)</td></tr>
<tr class="memdesc:a57734866cfa76a17da2cd78309267e00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns information about the current state of TPM.  <a href="#a57734866cfa76a17da2cd78309267e00">More...</a><br /></td></tr>
<tr class="separator:a57734866cfa76a17da2cd78309267e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc9e7d43339114afb55ea9039cb1d37b"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#adc9e7d43339114afb55ea9039cb1d37b">FirmwareUpdate_PrepareTPM20Policy</a> (_Out_ <a class="el" href="_t_p_m2___types_8h.html#adf8cd61604388f70af0ed90b7ed93c08">TPMI_SH_AUTH_SESSION</a> *PphPolicySession)</td></tr>
<tr class="memdesc:adc9e7d43339114afb55ea9039cb1d37b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares a policy session for TPM firmware.  <a href="#adc9e7d43339114afb55ea9039cb1d37b">More...</a><br /></td></tr>
<tr class="separator:adc9e7d43339114afb55ea9039cb1d37b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f87119fc895142e76ab98e1ddcfdbaf"><td class="memItemLeft" align="right" valign="top">_Check_return_ unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#a0f87119fc895142e76ab98e1ddcfdbaf">FirmwareUpdate_UpdateImage</a> (_In_ const <a class="el" href="struct_ifx_firmware_update_data.html">IfxFirmwareUpdateData</a> *const PpsFirmwareUpdateData)</td></tr>
<tr class="memdesc:a0f87119fc895142e76ab98e1ddcfdbaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to update the firmware with the given firmware image.  <a href="#a0f87119fc895142e76ab98e1ddcfdbaf">More...</a><br /></td></tr>
<tr class="separator:a0f87119fc895142e76ab98e1ddcfdbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afa7e419f96d0fd6b229a1acc8b39f4fd"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_firmware_update_8h.html#afa7e419f96d0fd6b229a1acc8b39f4fd">rgbTpm20FirmwareUpdatePolicyDigest</a> []</td></tr>
<tr class="memdesc:afa7e419f96d0fd6b229a1acc8b39f4fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This value is the policy for TPM20 firmware update.  <a href="#afa7e419f96d0fd6b229a1acc8b39f4fd">More...</a><br /></td></tr>
<tr class="separator:afa7e419f96d0fd6b229a1acc8b39f4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declares common firmware update functionality used by different tools. </p>
<p>Declares the internal firmware update interface used by IFXTPMUpdate and TPMFactoryUpd.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2014 - 2017 Infineon Technologies AG ( www.infineon.com )</dd>
<dd>
All rights reserved.</dd></dl>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</p><ol type="1">
<li>Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</li>
<li>Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission. THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. </li>
</ol>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1b8691f5d12f60b8d65ffa661601fd78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b8691f5d12f60b8d65ffa661601fd78">&#9670;&nbsp;</a></span>REMAINING_UPDATES_UNAVAILABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REMAINING_UPDATES_UNAVAILABLE&#160;&#160;&#160;(unsigned int)(-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This value indicates that the number of remaining firmware updates is unknown. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="abc0806f5fb50bb895b973508020604df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc0806f5fb50bb895b973508020604df">&#9670;&nbsp;</a></span>PFN_FIRMWAREUPDATE_PROGRESSCALLBACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned long long(* PFN_FIRMWAREUPDATE_PROGRESSCALLBACK) (unsigned long long PullCompletion)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function pointer type definition for Response_ProgressCallback. </p>

</div>
</div>
<a id="a62256d7910506f23f12dec62be3a6d6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62256d7910506f23f12dec62be3a6d6a">&#9670;&nbsp;</a></span>PFN_FIRMWAREUPDATE_UPDATESTARTEDCALLBACK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* PFN_FIRMWAREUPDATE_UPDATESTARTEDCALLBACK) ()</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function pointer type definition for UpdateStarted_Callback. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0377c76556033d78a1b3b1af60b6692a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0377c76556033d78a1b3b1af60b6692a">&#9670;&nbsp;</a></span>FirmwareUpdate_CalculateState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int FirmwareUpdate_CalculateState </td>
          <td>(</td>
          <td class="paramtype">_Out_ <a class="el" href="struct_t_p_m___s_t_a_t_e.html">TPM_STATE</a> *&#160;</td>
          <td class="paramname"><em>PpsTpmState</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the TPM state attributes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PpsTpmState</td><td>Pointer to a variable representing the TPM state</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. PpsTpmState is NULL. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. E.g. more than one property returned from TPM2_GetCapability call </td></tr>
    <tr><td class="paramname">...</td><td>Error codes from called functions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a845ea7abd1bced9eb1c358bc2e954d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a845ea7abd1bced9eb1c358bc2e954d8e">&#9670;&nbsp;</a></span>FirmwareUpdate_CheckImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int FirmwareUpdate_CheckImage </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(PullImageSize) <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *&#160;</td>
          <td class="paramname"><em>PrgbImage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_t_p_m2___types_8h.html#a95df6cdb32afc350ff070f2fe8a54a67">UINT64</a>&#160;</td>
          <td class="paramname"><em>PullImageSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_ <a class="el" href="_globals_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *&#160;</td>
          <td class="paramname"><em>PpfValid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_ <a class="el" href="struct_b_i_t_f_i_e_l_d___n_e_w___t_p_m___f_i_r_m_w_a_r_e___i_n_f_o.html">BITFIELD_NEW_TPM_FIRMWARE_INFO</a> *&#160;</td>
          <td class="paramname"><em>PpbfNewTpmFirmwareInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Out_ <a class="el" href="_t_p_m2___types_8h.html#adfe04a44baaebba6143c3a23507ff85b">UINT32</a> *&#160;</td>
          <td class="paramname"><em>PpunErrorDetails</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the firmware image is valid for the TPM. </p>
<p>Performs integrity, consistency and content checks to determine if the given firmware image can be applied to the installed TPM.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbImage</td><td>Firmware image byte stream </td></tr>
    <tr><td class="paramname">PullImageSize</td><td>Size of firmware image byte stream </td></tr>
    <tr><td class="paramname">PpfValid</td><td>TRUE in case the image is valid, FALSE otherwise. </td></tr>
    <tr><td class="paramname">PpbfNewTpmFirmwareInfo</td><td>Pointer to a bit field to return info data for the new firmware image. </td></tr>
    <tr><td class="paramname">PpunErrorDetails</td><td>Pointer to an unsigned int to return error details. Possible values are:<br />
 RC_E_FW_UPDATE_BLOCKED in case the field upgrade counter value has been exceeded.<br />
 RC_E_WRONG_FW_IMAGE in case the TPM is not updatable with the given image.<br />
 RC_E_CORRUPT_FW_IMAGE in case the firmware image is corrupt.<br />
 RC_E_NEWER_TOOL_REQUIRED in case a newer version of the tool is required to parse the firmware image.<br />
 RC_E_WRONG_DECRYPT_KEYS in case the TPM2.0 does not have decrypt keys matching to the firmware image.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. </td></tr>
    <tr><td class="paramname">RC_E_TPM20_FAILURE_MODE</td><td>The TPM2.0 is in failure mode. </td></tr>
    <tr><td class="paramname">RC_E_RESTART_REQUIRED</td><td>In case a restart is required to get back to a functional TPM </td></tr>
    <tr><td class="paramname">RC_E_NO_IFX_TPM</td><td>In case TPM vendor is not IFX </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">...</td><td>Error codes from called functions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab87fa675eeff94b93fe70af6949ff7c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87fa675eeff94b93fe70af6949ff7c2">&#9670;&nbsp;</a></span>FirmwareUpdate_CheckOwnerAuthorization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int FirmwareUpdate_CheckOwnerAuthorization </td>
          <td>(</td>
          <td class="paramtype">_In_bytecount_(<a class="el" href="_t_p_m2___types_8h.html#a3ba9296b223f1b3c710d6b812fd860e8">SHA1_DIGEST_SIZE</a>) const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>&#160;</td>
          <td class="paramname"><em>PrgbOwnerAuthHash</em>[SHA1_DIGEST_SIZE]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks TPM Owner authorization on TPM1.2. </p>
<p>The function checks TPM Owner authorization on TPM1.2 by calling TPM_ChangeAuthOwner with old and new TPM Owner authorization value set to the same value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PrgbOwnerAuthHash</td><td>TPM Owner Authentication hash (sha1)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An internal error occurred. </td></tr>
    <tr><td class="paramname">...</td><td>Error codes from called functions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a57734866cfa76a17da2cd78309267e00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57734866cfa76a17da2cd78309267e00">&#9670;&nbsp;</a></span>FirmwareUpdate_GetImageInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int FirmwareUpdate_GetImageInfo </td>
          <td>(</td>
          <td class="paramtype">_Inout_bytecap_ *PpunVersionNameSize wchar_t *&#160;</td>
          <td class="paramname"><em>PwszVersionName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Inout_ unsigned int *&#160;</td>
          <td class="paramname"><em>PpunVersionNameSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Inout_ <a class="el" href="struct_t_p_m___s_t_a_t_e.html">TPM_STATE</a> *&#160;</td>
          <td class="paramname"><em>PpsTpmState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Inout_ unsigned int *&#160;</td>
          <td class="paramname"><em>PpunRemainingUpdates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns information about the current state of TPM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PwszVersionName</td><td>A pointer to a null-terminated string representing the firmware image version name. </td></tr>
    <tr><td class="paramname">PpunVersionNameSize</td><td>IN: Capacity of the PwszVersionName parameter in wide characters including zero termination OUT: Length of written wide character string (excluding zero termination) </td></tr>
    <tr><td class="paramname">PpsTpmState</td><td>Receives TPM state. </td></tr>
    <tr><td class="paramname">PpunRemainingUpdates</td><td>Receives the number of remaining updates or -1 in case the value could not be detected.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. </td></tr>
    <tr><td class="paramname">RC_E_NO_IFX_TPM</td><td>The TPM is not manufactured by Infineon. </td></tr>
    <tr><td class="paramname">...</td><td>Error codes from called functions. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="adc9e7d43339114afb55ea9039cb1d37b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc9e7d43339114afb55ea9039cb1d37b">&#9670;&nbsp;</a></span>FirmwareUpdate_PrepareTPM20Policy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int FirmwareUpdate_PrepareTPM20Policy </td>
          <td>(</td>
          <td class="paramtype">_Out_ <a class="el" href="_t_p_m2___types_8h.html#adf8cd61604388f70af0ed90b7ed93c08">TPMI_SH_AUTH_SESSION</a> *&#160;</td>
          <td class="paramname"><em>PphPolicySession</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares a policy session for TPM firmware. </p>
<p>The function prepares a policy session for TPM Firmware Update.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PphPolicySession</td><td>Pointer to session handle that will be filled in by this method.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_BAD_PARAMETER</td><td>An invalid parameter was passed to the function. It is invalid or NULL. </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>An unexpected error occurred. </td></tr>
    <tr><td class="paramname">RC_E_PLATFORM_AUTH_NOT_EMPTY</td><td>In case PlatformAuth is not the Empty Buffer. </td></tr>
    <tr><td class="paramname">RC_E_PLATFORM_HIERARCHY_DISABLED</td><td>In case platform hierarchy has been disabled. </td></tr>
    <tr><td class="paramname">...</td><td>Error codes from called functions. like TPM error codes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0f87119fc895142e76ab98e1ddcfdbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f87119fc895142e76ab98e1ddcfdbaf">&#9670;&nbsp;</a></span>FirmwareUpdate_UpdateImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Check_return_ unsigned int FirmwareUpdate_UpdateImage </td>
          <td>(</td>
          <td class="paramtype">_In_ const <a class="el" href="struct_ifx_firmware_update_data.html">IfxFirmwareUpdateData</a> *const&#160;</td>
          <td class="paramname"><em>PpsFirmwareUpdateData</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to update the firmware with the given firmware image. </p>
<p>This function updates the TPM firmware with the image given in the parameters. A check if the firmware can be updated with the image is done before.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PpsFirmwareUpdateData</td><td>Pointer to structure containing all relevant data for a firmware update</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">RC_SUCCESS</td><td>The operation completed successfully. </td></tr>
    <tr><td class="paramname">RC_E_CORRUPT_FW_IMAGE</td><td>Policy parameter block is corrupt and/or cannot be unmarshalled. </td></tr>
    <tr><td class="paramname">RC_E_NO_IFX_TPM</td><td>The TPM is not manufactured by Infineon. </td></tr>
    <tr><td class="paramname">RC_E_TPM12_MISSING_OWNERAUTH</td><td>The TPM has an owner but TPM Owner authorization was not provided (TPM1.2 only). </td></tr>
    <tr><td class="paramname">RC_E_TPM12_NO_OWNER</td><td>The TPM does not have an owner but TPM Owner authorization was provided (TPM1.2 only). </td></tr>
    <tr><td class="paramname">RC_E_FAIL</td><td>TPM connection or command error. </td></tr>
    <tr><td class="paramname">...</td><td>Error codes from called functions. </td></tr>
    <tr><td class="paramname">RC_E_FIRMWARE_UPDATE_FAILED</td><td>The update operation was started but failed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="afa7e419f96d0fd6b229a1acc8b39f4fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7e419f96d0fd6b229a1acc8b39f4fd">&#9670;&nbsp;</a></span>rgbTpm20FirmwareUpdatePolicyDigest</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="_globals_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> rgbTpm20FirmwareUpdatePolicyDigest[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {0x6D, 0x9B, 0x4B, 0x75, 0x61, 0xCA, 0xC7, 0x7B,</div><div class="line">                                                            0x26, 0x1B, 0x31, 0xE2, 0x42, 0x31, 0xBD, 0x87,</div><div class="line">                                                            0x09, 0x7B, 0x47, 0x2E, 0x45, 0xF0, 0x7D, 0x4D,</div><div class="line">                                                            0x8F, 0xED, 0xDD, 0xB0, 0x4B, 0x91, 0x89, 0xF4}</div></div><!-- fragment -->
<p>This value is the policy for TPM20 firmware update. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/>
<p style="float: left; padding-left:0.2em"><font color="#E20036"><b>Restricted</b></font></p>
<p style="float: right;">Copyright © 2017 Infineon Technologies AG ( www.infineon.com ). All Rights Reserved.<br>&nbsp;</p>
</body>
</html>
